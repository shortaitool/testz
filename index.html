<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Free Job Test ‚Äî 2050 Theme</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#071028; --bg2:#0b1630; --card:#0f1724; --accent: #8fd3ff; --glass: rgba(255,255,255,0.04);
      --btn-border: rgba(255,255,255,0.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial; -webkit-font-smoothing:antialiased; color:#e6f0ff}
    body{
      background: radial-gradient(1200px 600px at 10% 20%, rgba(137,189,255,0.06), transparent 8%),
                  linear-gradient(180deg,var(--bg1),var(--bg2));
      padding:18px;display:flex;align-items:flex-start;justify-content:center;gap:18px;min-height:100vh;
    }

    .app{
      width:100%;max-width:1100px;display:grid;grid-template-columns:1fr 1.25fr;gap:18px;
    }

    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
    .title{
      display:flex;align-items:center;gap:14px
    }
    .logo{
      width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,#88d3ff33,#9bd1ff22);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:18px;color:var(--accent);backdrop-filter: blur(6px);box-shadow:0 6px 18px rgba(13,34,64,0.6) inset
    }
    h1{margin:0;font-size:20px;letter-spacing:0.4px}
    p.sub{margin:0;color:#9bb7d9;font-size:13px}

    .controls{display:flex;gap:10px;align-items:center}
    .btn{
      border:1px solid var(--btn-border);padding:10px 14px;border-radius:12px;background:transparent;color:inherit;font-weight:600;cursor:pointer;outline:none;position:relative;overflow:hidden;
      transition:transform .14s ease, box-shadow .14s ease;
      box-shadow: 0 6px 18px rgba(2,6,23,0.45);
    }
    .btn:active{transform:scale(.98)}
    .btn.outline{border:1px solid rgba(143,211,255,0.18)}
    .btn.admin{display:flex;gap:8px;align-items:center}

    /* main cards */
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:14px;box-shadow:0 8px 30px rgba(2,6,23,0.5);min-height:380px}

    /* left column categories */
    .categories{display:flex;flex-direction:column;gap:12px}
    .category{position:relative}
    .cat-btn{
      width:100%;text-align:left;padding:14px;border-radius:12px;border:1px solid var(--btn-border);background:transparent;display:flex;align-items:center;justify-content:space-between;gap:10px;font-weight:700;cursor:pointer;outline:none;
      transition:all .18s ease;backdrop-filter: blur(6px)
    }
    .cat-btn .name{display:flex;gap:10px;align-items:center}
    .cat-btn .dot{width:12px;height:12px;border-radius:4px;background:linear-gradient(180deg,#9bd1ff,#6fbfff);box-shadow:0 6px 14px rgba(110,170,255,0.12) inset}
    .cat-btn.active{background:linear-gradient(90deg, rgba(143,211,255,0.06), rgba(143,211,255,0.03));box-shadow:0 8px 30px rgba(15,60,120,0.12);border:1px solid rgba(143,211,255,0.26)}
    .cat-btn:after{content:'';position:absolute;left:0;top:0;bottom:0;width:0;border-radius:12px;pointer-events:none}

    .subtests{position:absolute;left:0;top:calc(100% + 10px);width:100%;padding:10px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 30px rgba(3,10,24,0.6);z-index:40;transform-origin:top;display:none}
    .category.open .subtests{display:block}
    .subtests .sbtn{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;margin-bottom:8px}
    .sbtn .sname{font-weight:600}
    .sbtn .play{font-size:13px;padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);cursor:pointer}
    .sbtn .play:active{transform:scale(.98)}

    /* right column viewer */
    .viewer{display:flex;flex-direction:column;gap:12px}
    .viewer .top{display:flex;align-items:center;justify-content:space-between}
    .viewer .frame-wrap{flex:1;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);min-height:360px;background:linear-gradient(180deg,#071428, #021022)}
    iframe{width:100%;height:100%;border:0}

    /* modal admin */
    .modal-back{position:fixed;inset:0;background:rgba(2,8,20,0.6);display:none;align-items:center;justify-content:center;padding:18px;z-index:999}
    .modal{width:100%;max-width:720px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:16px;border:1px solid rgba(255,255,255,0.03)}
    .modal h2{margin:0 0 8px 0}
    .form-row{display:flex;gap:8px;margin-bottom:10px}
    .form-row input[type=text], .form-row textarea, select{flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.05);background:transparent;color:inherit}
    textarea{min-height:120px}
    .tabs{display:flex;gap:8px;margin-bottom:12px}
    .tab{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
    .tab.active{background:linear-gradient(90deg, rgba(143,211,255,0.06), rgba(143,211,255,0.03));font-weight:700}

    .note{font-size:12px;color:#9bb7d9}

    /* responsive */
    @media (max-width:900px){
      .app{grid-template-columns:1fr;}
      .viewer{order:2}
    }

    /* small animations */
    .btn::after{content:'';position:absolute;left:-120%;top:0;height:100%;width:120%;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.06), rgba(255,255,255,0.02));transform:skewX(-16deg);transition:all .8s ease;opacity:0}
    .btn:hover::after{left: -10%;opacity:1}

    .cat-btn:active{transform:translateY(1px)}
    .sbtn:active{transform:translateY(1px)}

    .small{font-size:13px;color:#9bb7d9}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <div class="logo">FJT</div>
        <div>
          <h1>Free Job Test</h1>
          <p class="sub">Futuristic mobile-first test theme ‚Äî Admin-controlled</p>
        </div>
      </div>
      <div class="controls">
        <button class="btn outline" id="exportAll">Export Backup</button>
        <button class="btn admin" id="openAdmin">üîí Admin</button>
      </div>
    </header>

    <div class="panel">
      <div class="categories" id="categories"></div>
    </div>

    <div class="panel viewer">
      <div class="top">
        <div>
          <div class="small">Selected Test Preview</div>
          <div style="font-weight:700" id="viewerTitle">‡§ï‡•ã‡§à ‡§ü‡•á‡§∏‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ö‡•Å‡§®‡§æ ‡§ó‡§Ø‡§æ</div>
        </div>
        <div class="small note">‡§ü‡§ø‡§™: ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ ‡§∏‡•á ‡§®‡§à ‡§ü‡•á‡§∏‡•ç‚Äç‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç ‚Äî ‡§µ‡•ã ‡§ë‡§ü‡•ã-‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡•Ä</div>
      </div>
      <div class="frame-wrap" id="frameWrap">
        <iframe id="testFrame" sandbox="allow-same-origin allow-scripts"></iframe>
      </div>
    </div>

  </div>

  <!-- ADMIN MODAL -->
  <div class="modal-back" id="modalBack">
    <div class="modal" role="dialog">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h2 id="adminHeading">Admin Panel</h2>
        <div>
          <button class="btn" id="adminLogout" style="display:none">Logout</button>
          <button class="btn" id="closeModal">Close</button>
        </div>
      </div>

      <div id="loginArea">
        <div class="note">Admin access required. ‡§™‡§π‡§≤‡•Ä ‡§¨‡§æ‡§∞ ‡§≤‡§ó‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§®‡§Ø‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§</div>
        <div class="form-row" style="margin-top:10px">
          <input type="password" id="adminPw" placeholder="Admin Password" />
          <button class="btn" id="loginBtn">Login / Set</button>
        </div>
      </div>

      <div id="adminArea" style="display:none">
        <div class="tabs" id="tabs">
          <div class="tab active" data-tab="manage">Manage</div>
          <div class="tab" data-tab="add">Add Test</div>
          <div class="tab" data-tab="import">Import / Export</div>
          <div class="tab" data-tab="prefs">Settings</div>
        </div>

        <div id="tab-manage" class="tabpanel">
          <div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap">
            <input type="text" id="newCatName" placeholder="‡§®‡§à ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ (‡§â‡§¶‡§æ: Delhi Police)" />
            <button class="btn" id="addCatBtn">Add Category</button>
          </div>

          <div id="manageList" style="max-height:220px;overflow:auto"></div>
        </div>

        <div id="tab-add" class="tabpanel" style="display:none">
          <div class="form-row">
            <select id="selectCat"></select>
            <input type="text" id="subtestName" placeholder="Subtest ‡§ï‡§æ ‡§®‡§æ‡§Æ" />
          </div>

          <div style="display:flex;gap:8px;margin-bottom:8px">
            <input type="file" id="fileHtml" accept="text/html" />
            <button class="btn" id="pasteBtn">Paste HTML</button>
            <button class="btn" id="saveSubtest">Save</button>
          </div>

          <textarea id="htmlContent" placeholder="‡§Ø‡§æ ‡§Ø‡§π‡§æ‡§Å HTML ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§Ø‡§æ ‡§´‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç)"></textarea>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn" id="previewAdmin">Preview</button>
            <button class="btn" id="clearHtml">Clear</button>
          </div>
          <div id="adminPreview" style="margin-top:12px;border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);min-height:120px"></div>
        </div>

        <div id="tab-import" class="tabpanel" style="display:none">
          <div style="display:flex;gap:8px;margin-bottom:8px">
            <button class="btn" id="exportBtn">Download JSON Backup</button>
            <input type="file" id="importFile" accept="application/json" />
          </div>
          <div class="note">Export ‡§ï‡§∞‡§ï‡•á ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§∞‡§ñ‡•á‡§Ç ‚Äî localStorage ‡§ï‡•ç‡§≤‡§ø‡§Ø‡§∞ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§Ü‡§™ ‡§á‡§∏‡•á Import ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§</div>
        </div>

        <div id="tab-prefs" class="tabpanel" style="display:none">
          <div class="form-row">
            <input type="password" id="currentPw" placeholder="Current Password (‡§Ö‡§ó‡§∞ ‡§∏‡•á‡§ü ‡§π‡•à)" />
            <input type="password" id="newPw" placeholder="New Password" />
            <button class="btn" id="changePw">Change</button>
          </div>
          <div class="note">‡§®‡•ã‡§ü: ‡§Ø‡§π ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§ø‡§∞‡•ç‡§´ client-side ‡§Æ‡•á‡§Ç localStorage ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ (‡§Ø‡§æ‡§®‡•Ä ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è server ‡§ö‡§æ‡§π‡§ø‡§è)‡•§</div>
        </div>

      </div>

    </div>
  </div>

  <script>
    // ===== data structure =====
    const STORAGE_KEY = 'fj_data_v1';
    let state = {categories:[], subtests:[], adminPassword:null};
    let adminLogged = false;

    // default categories (approx 10 as user requested)
    const defaultCats = [
      'Delhi Police Test','Rajasthan Police Test','UP Police Test','Bihar Police Test','Haryana Police Test',
      'Railway Group D Test','Railway NTPC Test','Rajasthan Group D','SSC CGL','Bank PO'
    ];

    // util
    const uid = (p='id')=> p + '-' + Math.random().toString(36).slice(2,9);

    function load(){
      try{
        const s = localStorage.getItem(STORAGE_KEY);
        if(s){ state = JSON.parse(s); }
        else{
          state.categories = defaultCats.map((n,i)=>({id:uid('cat'),name:n}));
          state.subtests = [];
          // do not set password by default so admin must set
          state.adminPassword = null;
          save();
        }
      }catch(e){console.error(e); state = {categories:[],subtests:[],adminPassword:null};}
    }
    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

    // render
    function renderCategories(){
      const container = document.getElementById('categories'); container.innerHTML='';
      state.categories.forEach(cat=>{
        const c = document.createElement('div'); c.className='category'; c.dataset.id = cat.id;
        const btn = document.createElement('button'); btn.className='cat-btn';
        btn.innerHTML = `<div class="name"><div class="dot"></div><div style=\"min-width:120px\">${cat.name}</div></div><div style=\"opacity:.9\">‚ñæ</div>`;
        btn.addEventListener('click',()=>{ toggleCategory(cat.id, c); });
        c.appendChild(btn);

        const dropdown = document.createElement('div'); dropdown.className='subtests';
        const subs = state.subtests.filter(s=>s.catId===cat.id);
        if(subs.length===0){
          const p = document.createElement('div'); p.className='small'; p.style.padding='6px'; p.textContent='‡§ï‡•ã‡§à ‡§∏‡§¨-‡§ü‡•á‡§∏‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç‡•§ (Admin ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡•á‡§Ç)'; dropdown.appendChild(p);
        } else {
          subs.forEach(s=>{
            const row = document.createElement('div'); row.className='sbtn';
            const left = document.createElement('div'); left.className='sname'; left.textContent = s.name;
            const right = document.createElement('div');
            const open = document.createElement('button'); open.className='play'; open.textContent='Start';
            open.addEventListener('click', ()=> openSubtest(s.id));
            const more = document.createElement('button'); more.className='play'; more.textContent='‚ãØ';
            more.addEventListener('click', ()=> adminQuickActions(s.id));
            right.appendChild(open); right.appendChild(more);
            row.appendChild(left); row.appendChild(right);
            dropdown.appendChild(row);
          })
        }

        c.appendChild(dropdown);
        container.appendChild(c);
      })
      // Update select in admin
      refreshSelectCat();
    }

    function toggleCategory(catId, el){
      // close others
      document.querySelectorAll('.category').forEach(node=>{
        if(node.dataset.id===catId) node.classList.toggle('open'); else node.classList.remove('open');
      })
      // set active style
      document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
      const catBtn = el.querySelector('.cat-btn'); if(el.classList.contains('open')) catBtn.classList.add('active');
      else catBtn.classList.remove('active');
    }

    function openSubtest(subId){
      const s = state.subtests.find(x=>x.id===subId); if(!s) return;
      document.getElementById('viewerTitle').textContent = s.name;
      const iframe = document.getElementById('testFrame');
      try{
        iframe.srcdoc = s.content; // render directly
      }catch(e){
        // fallback: blob
        const blob = new Blob([s.content], {type:'text/html'});
        const url = URL.createObjectURL(blob);
        iframe.src = url;
        setTimeout(()=> URL.revokeObjectURL(url), 60000);
      }
      // scroll iframe into view on small screens
      document.getElementById('frameWrap').scrollIntoView({behavior:'smooth'});
    }

    // admin quick actions: preview, delete
    function adminQuickActions(subId){
      if(!adminLogged){ alert('Admin login required to manage tests'); return; }
      const s = state.subtests.find(x=>x.id===subId);
      if(!s) return;
      const doIt = confirm('Delete subtest "'+s.name+'" ? (OK to delete)');
      if(doIt){ state.subtests = state.subtests.filter(x=>x.id!==subId); save(); renderCategories(); alert('Deleted'); }
    }

    // admin features
    function refreshSelectCat(){
      const sel = document.getElementById('selectCat'); sel.innerHTML='';
      state.categories.forEach(c=>{ const opt = document.createElement('option'); opt.value=c.id; opt.textContent = c.name; sel.appendChild(opt); })
    }

    document.getElementById('openAdmin').addEventListener('click', ()=>{
      document.getElementById('modalBack').style.display='flex';
      updateAdminUI();
    });
    document.getElementById('closeModal').addEventListener('click', ()=>{
      document.getElementById('modalBack').style.display='none';
    });

    document.getElementById('loginBtn').addEventListener('click', ()=>{
      const pw = document.getElementById('adminPw').value.trim();
      if(!pw){ alert('‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ö‡§æ‡§π‡§ø‡§è'); return; }
      const stored = state.adminPassword;
      if(!stored){ // first time set
        if(!confirm('‡§Ø‡§π ‡§™‡§π‡§≤‡•Ä ‡§¨‡§æ‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ Set '+pw+' as admin password?')) return;
        state.adminPassword = pw; save(); adminLogged=true; updateAdminUI(); alert('Password set ‡§î‡§∞ ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•Å‡§Ü');
      } else {
        if(pw===stored){ adminLogged=true; updateAdminUI(); alert('Logged in'); }
        else alert('‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°');
      }
      document.getElementById('adminPw').value='';
    });

    function updateAdminUI(){
      if(adminLogged){
        document.getElementById('loginArea').style.display='none';
        document.getElementById('adminArea').style.display='block';
        document.getElementById('adminLogout').style.display='inline-block';
        document.getElementById('adminHeading').textContent = 'Admin Panel ‚Äî Logged In';
      } else {
        document.getElementById('loginArea').style.display='block';
        document.getElementById('adminArea').style.display='none';
        document.getElementById('adminLogout').style.display='none';
        document.getElementById('adminHeading').textContent = 'Admin Panel';
      }
    }

    document.getElementById('adminLogout').addEventListener('click', ()=>{ adminLogged=false; updateAdminUI(); });

    // tabs
    document.querySelectorAll('.tab').forEach(t=> t.addEventListener('click', ()=>{
      document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      document.querySelectorAll('.tabpanel').forEach(p=>p.style.display='none');
      document.getElementById('tab-'+t.dataset.tab).style.display='block';
    }));

    // add category
    document.getElementById('addCatBtn').addEventListener('click', ()=>{
      const v = document.getElementById('newCatName').value.trim();
      if(!v) return alert('‡§®‡§æ‡§Æ ‡§°‡§æ‡§≤‡•á‡§Ç');
      state.categories.push({id:uid('cat'),name:v}); save(); renderCategories(); document.getElementById('newCatName').value='';
    });

    // file upload to textarea
    document.getElementById('fileHtml').addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return;
      const reader = new FileReader();
      reader.onload = evt => { document.getElementById('htmlContent').value = evt.target.result; }
      reader.readAsText(f,'utf-8');
    });

    document.getElementById('pasteBtn').addEventListener('click', ()=>{
      const t = document.getElementById('htmlContent'); t.focus(); t.select(); document.execCommand('paste'); // may not always work in browsers
      alert('‡§Ö‡§¨ HTML ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ File ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ Save ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç');
    });

    document.getElementById('saveSubtest').addEventListener('click', ()=>{
      if(!adminLogged){ alert('Admin login ‡§ï‡§∞‡•á‡§Ç'); return; }
      const catId = document.getElementById('selectCat').value; const name = document.getElementById('subtestName').value.trim(); const html = document.getElementById('htmlContent').value;
      if(!catId || !name || !html) return alert('Category, Subtest ‡§®‡§æ‡§Æ ‡§î‡§∞ HTML ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡§Ç');
      state.subtests.push({id:uid('st'),catId, name, content:html, createdAt:Date.now()}); save(); renderCategories(); document.getElementById('subtestName').value=''; document.getElementById('htmlContent').value=''; document.getElementById('adminPreview').innerHTML=''; alert('Subtest saved and available immediately');
    });

    document.getElementById('previewAdmin').addEventListener('click', ()=>{
      const html = document.getElementById('htmlContent').value; if(!html) return alert('‡§™‡§π‡§≤‡•á HTML ‡§°‡§æ‡§≤‡•á');
      document.getElementById('adminPreview').innerHTML = '<iframe sandbox="allow-scripts allow-same-origin" style="width:100%;height:240px;border:0" srcdoc="'+escapeForSrcdoc(html)+'"></iframe>';
    });

    function escapeForSrcdoc(s){ return s.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/\n/g,'\n'); }

    document.getElementById('clearHtml').addEventListener('click', ()=>{ document.getElementById('htmlContent').value=''; document.getElementById('adminPreview').innerHTML=''; });

    // export and import
    document.getElementById('exportBtn').addEventListener('click', ()=>{ downloadJSON(state, 'free-job-test-backup.json'); });
    document.getElementById('exportAll').addEventListener('click', ()=>{ downloadJSON(state, 'free-job-test-backup.json'); alert('Backup ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§π‡•ã ‡§ó‡§Ø‡§æ (‡§Ø‡§¶‡§ø ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ÂÖÅ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á)'); });

    document.getElementById('importFile').addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = ev=>{
        try{ const imported = JSON.parse(ev.target.result); if(!imported.categories) return alert('‡§ó‡§≤‡§§ ‡§´‡§æ‡§á‡§≤'); if(confirm('Import ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ data ‡§¨‡§¶‡§≤ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§ Continue?')){ state = imported; save(); renderCategories(); alert('Imported'); document.getElementById('modalBack').style.display='none'; }}catch(err){alert('Import error')}
      }; r.readAsText(f,'utf-8');
    });

    function downloadJSON(obj, filename){ const blob = new Blob([JSON.stringify(obj, null, 2)], {type:'application/json'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download=filename; document.body.appendChild(a); a.click(); a.remove(); setTimeout(()=>URL.revokeObjectURL(url), 60000); }

    // change password
    document.getElementById('changePw').addEventListener('click', ()=>{
      const cur = document.getElementById('currentPw').value; const nw = document.getElementById('newPw').value; if(!nw) return alert('‡§®‡§Ø‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç');
      if(state.adminPassword && state.adminPassword !== cur) return alert('Current password ‡§ó‡§≤‡§§');
      state.adminPassword = nw; save(); alert('Password ‡§¨‡§¶‡§≤‡§æ ‡§ó‡§Ø‡§æ'); document.getElementById('currentPw').value=''; document.getElementById('newPw').value='';
    });

    // init
    load(); renderCategories();

    // HELPFUL NOTES for user (not displayed) ‚Äî but we will show instructions in chat.

  </script>
</body>
</html>
